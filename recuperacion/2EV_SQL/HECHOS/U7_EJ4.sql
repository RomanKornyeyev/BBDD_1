/*SI NO ESTÁ ON DELETE CASCADE, ESTÁ EN MODO RESTRINGIDO, ES DECIR,
SI TENEMOS EL ALUMNO EN "ALUMNO" E "IMPARTE" E INTENTAMOS BORRARLO DE ALUMNO,
NO NOS VA A DEJAR*/
DROP TABLE ASIGNATURA cascade constraints; 
CREATE TABLE ASIGNATURA (
    COD_ASIG VARCHAR (10) CONSTRAINT PK_ASIG PRIMARY KEY,
    NB_ASIG VARCHAR (20)
);

DROP TABLE DEPARTAMENTO cascade constraints; 
CREATE TABLE DEPARTAMENTO(
    COD_DEP VARCHAR (20) CONSTRAINT PK_DEP PRIMARY KEY,
    NB_DEP VARCHAR (20)
);

DROP TABLE PROFESOR cascade constraints; 
CREATE TABLE PROFESOR (
     DNI_PROF VARCHAR (20) PRIMARY KEY,
     NB_PROF VARCHAR (20),
     DIR_PROF VARCHAR (20),
     TF_PROF NUMBER (20),
     SUELDO_PROF NUMBER (10),
     COD_DEP VARCHAR (20),
     CONSTRAINT FK_DEP FOREIGN KEY (COD_DEP) REFERENCES DEPARTAMENTO(COD_DEP) ON DELETE CASCADE
);

DROP TABLE ALUMNO cascade constraints;
CREATE TABLE ALUMNO (
    DNI_ALUM VARCHAR (20) PRIMARY KEY,
    NB_ALUM VARCHAR (20),
    DIR_ALUM VARCHAR (20),
    TF_ALUM NUMBER (20),
    FECHA_NAC DATE
);

DROP TABLE IMPARTE cascade constraints;
CREATE TABLE IMPARTE (
    COD_ASIG VARCHAR (10),
    DNI_PROF VARCHAR (20),
    DNI_ALUM VARCHAR (20),
    CONSTRAINT PK_IMP PRIMARY KEY (COD_ASIG,DNI_PROF,DNI_ALUM),
    CONSTRAINT FK_ASIG FOREIGN KEY (COD_ASIG) REFERENCES ASIGNATURA(COD_ASIG) ON DELETE CASCADE,
    CONSTRAINT FK_PROF FOREIGN KEY (DNI_PROF) REFERENCES PROFESOR(DNI_PROF) ON DELETE CASCADE,
    CONSTRAINT FK_ALUM FOREIGN KEY (DNI_ALUM) REFERENCES ALUMNO(DNI_ALUM) ON DELETE CASCADE
);

/* === INSERTS ===*/

INSERT INTO ASIGNATURA VALUES ('001','BD');
INSERT INTO ASIGNATURA VALUES ('002','SERVIDOR');
INSERT INTO ASIGNATURA VALUES ('003','DESPLIEGUE');
COMMIT;

INSERT INTO DEPARTAMENTO VALUES ('I01','INFORMATICA');
COMMIT;

INSERT INTO PROFESOR VALUES ('000000001','CARMEN','C/Sol 20',600000001,2500,'I01');
INSERT INTO PROFESOR VALUES ('000000002','JORGE','C/Luna 15',600000002,2500,'I01');
INSERT INTO PROFESOR VALUES ('000000003','JAKELIN','C/Hola 10',600000003,2500,'I01');
COMMIT;

INSERT INTO ALUMNO VALUES ('000000010','ROMAN','C/Marchamalo 20',600000010,'01-12-1997');
INSERT INTO ALUMNO VALUES ('000000011','JAVIER','C/Hola 20',600000011,'01-12-1995');
INSERT INTO ALUMNO VALUES ('000000012','HENRY','C/Patata 15',600000012,'01-12-2000');
COMMIT;

INSERT INTO IMPARTE VALUES ('001','000000001','000000010');
INSERT INTO IMPARTE VALUES ('002','000000001','000000010');
INSERT INTO IMPARTE VALUES ('003','000000001','000000010');
INSERT INTO IMPARTE VALUES ('002','000000002','000000011');
INSERT INTO IMPARTE VALUES ('003','000000003','000000012');
COMMIT;

/* === SELECTS === */

DESC ASIGNATURA;
DESC DEPARTAMENTO;
DESC PROFESOR;
DESC ALUMNO;
DESC IMPARTE;

SELECT * FROM ASIGNATURA;
SELECT * FROM DEPARTAMENTO;
SELECT * FROM PROFESOR;
SELECT * FROM ALUMNO;
SELECT * FROM IMPARTE;
